############################################################################################################
module Aethyr

  ############################################################################################################
  module Linux
  
    ############################################################################################################
    module Interface
    
      ##########################################################################################################
      class FileSystems
  
        ######################################################################################################
        #### class methods
        class << self
  
          ########################################################################################################
          def find(type = :all, options = {})
            if type.eql?(:first)
            else
              self.find_all
            end
          end

        ######################################################################################################
        protected
    
          ##########################################################################################################
          def find_all

            fs = {}
            
            rows = `df -k`.split("\n")
            rows.shift
            rows.each do |r|
              attrs = r.split(/\s+/)
              fs[attrs[0]] = {
               :name       => attrs[0], 
               :size       => attrs[1],
               :size_units => 'KB',               
               :mount      => attrs[5],
              }
            end    
            
            rows = `cat /etc/mtab`.split("\n")
            rows.each do |r|
              attrs = r.split(/\s+/)
              fs[attrs[0]].update(
                                     :file_system_type => attrs[2],
                                     :mount_options    => attrs[3],
                                     :backup_frequency => attrs[4],
                                     :fsck_order       => attrs[5]
                                     ) unless fs[attrs[0]].nil?
            end

            fs.values
            
          end
    
        ######################################################################################################
        end  
        
      ##########################################################################################################
      end
  
    ##########################################################################################################
    end

  ##########################################################################################################
  end
  
##########################################################################################################
end
